<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <script src='https://cdn.firebase.com/js/client/2.2.1/firebase.js'></script>

    <style>
        html,
        body {
            height: 100%;
            margin: 0;
            padding: 0;
        }
        
        #map {
            height: 100%;
        }
    </style>

    <title>Boboulo</title>

    <link rel="stylesheet" href="css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/font-awesome.min.css">
    <link rel="stylesheet" href="css/bootstrap-social.css">
    <link rel="stylesheet" href="css/mystyles.css">

</head>

<body>

    <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="#">Boboulo</a>
            </div>
            <div id="navbar" class="navbar-collapse collapse">
                <ul class="nav navbar-nav">
                    <li class="active">
                        <a href="#">
                            <span class="glyphicon glyphicon-home" aria-hidden="true"></span> Home</a>
                    </li>
                    <li><a href="aboutus_ori.html"><span class="glyphicon glyphicon-info-sign"
                                                         aria-hidden="true"></span> About</a></li>

                    <li><a href="#"><span class="glyphicon glyphicon-user"
                                          aria-hidden="true"></span> User</a></li>
                    <li><a href="#"><span class="glyphicon glyphicon-user"
                                          aria-hidden="true"></span> Adviser</a></li>
                    <li><a href="#">Contact</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <header class="jumbotron">

        <!-- Main component for a primary marketing message or call to action -->

        <div class="container">
            <div class="row row-header">
                <div class="col-xs-12 col-sm-8">
                    <h1>Boboulo manage your applications!</h1>
                    <p style="padding:40px;"></p>
                    <p>his tool helps people looking for a job to manage the applications they perform. Among the features available, users can easily create a new application and easily search/access to the data of any of his applications. In addition, the adviser can access to the applications of people he supports. In a futur version a page dedicated for employer should be added </p>
                </div>
                <div class="col-xs-12 col-sm-4">
                </div>
            </div>
        </div>
    </header>



    <div class="container">



        <div class="row row-content">
            <div class="col-xs-12 col-sm-3 col-sm-push-9">
                <p style="padding:20px;"></p>
                <h3 align=center>E-cockpit</h3>
            </div>
            <div class="col-xs-12 col-sm-9 col-sm-pull-3">
                <h2>Applications state</h2>
                <div id="piechart" style="width: 900px; height: 500px;"></div>
                <input id="pieInput" type="text">
                <button id="pieBtn">OK</button>
                <p><a href="#">More &raquo;</a></p>
            </div>
        </div>


        <div class="row row-content">
            <div class="col-xs-12 col-sm-3">
                <p style="padding:20px;"></p>
                <h3 align=center>Locations</h3>
            </div>
            <div class="col-xs-12 col-sm-9" style="height: 500px">
                <p><a href="#">More &raquo;</a></p>
                <button id="btn">OK</button>
                <div id="map"></div>
            </div>
        </div>

        <div class="row row-content">
            <div class="col-xs-12 col-sm-3 col-sm-push-9">
                <p style="padding:20px;"></p>
                <h3 align=center>Applications List</h3>
            </div>
            <div class="col-xs-12 col-sm-9 col-sm-pull-3">
                <h4>list</h4>
                <p></p>
                <p><a href="#">More &raquo;</a></p>
            </div>
        </div>
    </div>

    <footer class="row-footer">
        <div class="container">
            <div class="row">
                <div class="col-xs-5 col-xs-offset-1 col-sm-2 col-sm-offset-1">
                    <h5>Links</h5>
                    <ul class="list-unstyled">
                        <li><a href="#">Home</a></li>
                        <li><a href="#">About</a></li>
                        <li><a href="#">User</a></li>
                        <li><a href="#">Adviser</a></li>
                    </ul>
                </div>
                <div class="col-xs-6 col-sm-5">
                    <h5>Our Address</h5>
                    <address>
		              121, Clear Water Bay Road<br>
		              Clear Water Bay, Kowloon<br>
		              Geneva<br>
		              <i class="fa fa-phone"></i>: +41 1234 5678<br>
		              <i class="fa fa-fax"></i>: +41 8765 4321<br>
		              <i class="fa fa-envelope"></i>: <a href="mailto:confusion@food.net">dada@boboulo.net</a>
		           </address>
                </div>
                <div class="col-xs-12 col-sm-4">
                    <div class="nav navbar-nav" style="padding: 40px 10px;">
                        <a class="btn btn-social-icon btn-google-plus" href="http://google.com/+"><i class="fa fa-google-plus"></i></a>
                        <a class="btn btn-social-icon btn-facebook" href="http://www.facebook.com/profile.php?id=">
                            <i class="fa fa fa-facebook"></i></a>
                        <a class="btn btn-social-icon btn-linkedin" href="http://www.linkedin.com/in/">
                            <i class="fa fa-linkedin"></i></a>
                        <a class="btn btn-social-icon btn-twitter" href="http://twitter.com/">
                            <i class="fa fa-twitter"></i></a>
                        <a class="btn btn-social-icon btn-youtube" href="http://youtube.com/">
                            <i class="fa fa-youtube"></i></a>
                        <a href="mailto:"><i class="fa fa-envelope-o"></i></a>
                    </div>
                </div>
                <div class="col-xs-12">
                    <p style="padding:10px;"></p>
                    <p align=center>Â© Copyright 2016 boboulo</p>
                </div>
            </div>
        </div>
    </footer>


    <script>
        var map;
        var myLatlng = {
            lat: -25.363,
            lng: 131.044
        };
        var geo;
        var geocoder;

        function initMap() {
            map = new google.maps.Map(document.getElementById('map'), {
                center: myLatlng,
                zoom: 4
            });

            var marker = new google.maps.Marker({
                position: myLatlng,
                map: map,
                title: 'Click to zoom'
            });

            marker.addListener('click', function () {
                map.setZoom(8);
                map.setCenter(marker.getPosition());
            });

            geocoder = new google.maps.Geocoder();

        }

        function geocodeAddress(address) {
            geocoder.geocode({
                'address': address
            }, function (results, status) {
                if (status === google.maps.GeocoderStatus.OK) {
                    map.setCenter(results[0].geometry.location);
                    map.setZoom(12);
                    var marker = new google.maps.Marker({
                        map: map,
                        position: results[0].geometry.location,
                    });
                } else {
                    alert('Geocode was not successful for the following reason: ' + status);
                }
            });
        }

        document.getElementById("btn").addEventListener("click", function () {
            geocodeAddress("marinduque philippines");
        });

        var x = -25;
        var y = 133;


        function addMarker() {
            var marker = new google.maps.Marker({
                position: {
                    lat: x++,
                    lng: y++
                },
                map: map,
                title: 'Click to zoom'
            });
        }
    </script>

    <script>
        document.getElementById("pieBtn").addEventListener("click", updatePie);

        function updatePie() {
            var appPerCategories = [];
            var counter = 0;
            var name = document.getElementById('pieInput').value;

            appPerCategories.push(['Applications', 'number of app per categories']);


            applicationsRef.child(name).once("value", function (snapshot) {

                snapshot.forEach(function (data) {
                    console.log(name + " applications : company : " + data.val().company);
                    $.each(data.val().categories, function (i, n) {
                        console.log(name + " category : " + i);
                        counter += 10;
                        var tmp = [i, counter];
                        appPerCategories.push(tmp);
                    });
                    var queryRef = companiesRef.child(data.val().company);
                    queryRef.on("value", function (querySnapshot) {
                        console.log(name + " applications pour company : " + querySnapshot.val().name + " a: " + querySnapshot.val().address);
                    });
                });

                var data = google.visualization.arrayToDataTable(appPerCategories);

                var options = {
                    title: 'My applications',
                    is3D: true,
                };

                var chart = new google.visualization.PieChart(document.getElementById('piechart'));

                chart.draw(data, options);


            });



        }
    </script>

    <script>
        var myDataRef = new Firebase('https://d4riwejbb99.firebaseio-demo.com/');
        var applicationsRef = myDataRef.child("applications");
        var companiesRef = myDataRef.child("companies");
        var categoriesRef = myDataRef.child("categories");
        var statesRef = myDataRef.child("states");


        var categories;

        //initFire();

        /*
                //list of all applications (company name and position) for a user
                applicationsRef.child("luis").on("child_added", function (snapshot) {
                    console.log("luis applications : " + snapshot.val().company + " " + snapshot.val().position);
                }, function (errorObject) {
                    console.log("The read failed: " + errorObject.code);
                });

                applicationsRef.child("dadakoko").on("child_added", function (snapshot) {
                    console.log("david applications : " + snapshot.val().company + " " + snapshot.val().position);
                });

                //list of all applications (company name and address) for a user
                applicationsRef.child("dadakoko").on("value", function (snapshot) {
                    snapshot.forEach(function (data) {
                        var queryRef = companiesRef.child(data.val().company);
                        queryRef.on("value", function (querySnapshot) {
                            console.log("david applications pour company : " + querySnapshot.val().name + " a: " + querySnapshot.val().address);
                        });
                    });
                });
        */

        //list of companies
        //list of users
        //list of states
        //list of categories
        categoriesRef.once("value", function (snap) {
            categories = $.map(snap.val(), function (value, index) {
                return [index];
            });
            var applicationPerCategories = [];
            applicationPerCategories.push(['Applications', 'number of app per categories']);
            $.each(categories, function (i, n) {
                var tmp = [n, 10];
                applicationPerCategories.push(tmp);
            });

            console.log(applicationPerCategories);
            var data = google.visualization.arrayToDataTable(applicationPerCategories);

            var options = {
                title: 'My applications',
                is3D: true,
            };

            var chart = new google.visualization.PieChart(document.getElementById('piechart'));

            chart.draw(data, options);


        });


        /*
                //dadakoko add a new application
                //first add the company that is not stored yet
                var cern = {
                    cern: {
                        name: "CERN",
                        address: "meyrin"
                    }
                };
                companiesRef.update(cern);
                //second: add dadakoko as a candidate
                companiesRef.child("cern").child("candidates").update({
                    "dadakoko": true
                });
                //finally: add the application
                var application6 = {
                    date: "31/12",
                    state: "ongoing",
                    company: "cern",
                    position: "particule elementaire",
                    categories: {
                        cascade: true
                    }
                };
                applicationsRef.child("dadakoko").push().set(application6);
        */

        function initFire() {
            var users = {
                users: {
                    dadakoko: {
                        username: "California",
                        friends: {
                            luis: true,
                            ella: true
                        }
                    },
                    luis: {
                        username: "luisb",
                        friends: {
                            dadakoko: true
                        }
                    },
                    ella: {
                        username: "elafizt",
                        friends: {
                            dadakoko: true
                        }
                    }
                }
            };

            myDataRef.set(users);

            var luisRef = applicationsRef.child("luis");

            var application1 = {
                date: "10/07",
                state: "ongoing",
                company: "sacpi",
                position: "president director",
                categories: {
                    informatique: true,
                    management: true
                }
            };

            var application3 = {
                date: "10/10",
                state: "rejected",
                company: "pectit",
                position: "trader",
                categories: {
                    shark: true
                }
            };

            luisRef.push().set(application3);
            luisRef.push().set(application1);

            var dadaRef = applicationsRef.child("dadakoko");
            var application2 = {
                date: "23/10",
                state: "ongoing",
                company: "pectit",
                position: "web developer",
                categories: {
                    shark: true
                }
            };

            var application4 = {
                date: "31/12",
                state: "accepted",
                company: "nomades",
                position: "prof",
                categories: {
                    prof: true,
                    informatique: true
                }
            };

            dadaRef.push().set(application4);
            dadaRef.push().set(application2);

            var ellaRef = applicationsRef.child("ella");
            var application5 = {
                date: "31/12",
                state: "accepted",
                company: "nomades",
                position: "prof",
                categories: {
                    prof: true,
                    informatique: true
                }
            };

            ellaRef.push().set(application5);

            var companies = {
                sacpi: {
                    name: "sacpi SA",
                    address: "prilly",
                    candidates: {
                        luis: true
                    }
                },
                pectit: {
                    name: "pectit bank",
                    address: "petit lancy",
                    candidates: {
                        dadakoko: true,
                        luis: true
                    }
                },
                nomades: {
                    name: "nomades ateliers",
                    address: "rue des acacias geneve",
                    candidates: {
                        dadakoko: true,
                        ella: true
                    }
                },
                victoria: {
                    name: "victoria hall",
                    address: "plainpalais geneve",
                    candidates: {}
                }
            };

            companiesRef.set(companies);

            var categories = {
                informatique: true,
                shark: true,
                prof: true,
                cascade: true,
                music: true
            };

            categoriesRef.set(categories);

            var states = {
                accepted: true,
                rejected: true,
                ongoing: true
            };

            statesRef.set(states);

        }
    </script>

    <script src="https://www.gstatic.com/charts/loader.js"></script>

    <script>
        google.charts.load('current', {
            'packages': ['corechart']
        });
        google.charts.setOnLoadCallback(drawChart);

        /*        function drawChart() {

                    var data = google.visualization.arrayToDataTable([
                        ['Task', 'Hours per Day'],
                        ['Giliw kiss', 11],
                        ['Eat with giliw', 2],
                        ['Commute', 2],
                        ['Watch TV', 2],
                        ['Sleep with giliw', 7]
                    ]);

                    var options = {
                        title: 'My Daily Activities',
                        is3D: true,
                    };

                    var chart = new google.visualization.PieChart(document.getElementById('piechart'));

                    chart.draw(data, options);

                }
        */
    </script>

    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD2POV4QB0x48pf1YHsts9bX49P6eVMiOU&callback=initMap" async defer></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
    <script src="js/bootstrap.min.js"></script>

</body>

</html>